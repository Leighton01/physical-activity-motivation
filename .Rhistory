child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender)) %>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE))
) %>%
ungroup()
dall <- bind_rows(
adult.trim %>% mutate(group = "adult"),
child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender))%>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE))
) %>%
ungroup()
# Standardize age globally
dall$age_r <- scale(dall$age)[,1]
dall <- bind_rows(
adult.trim %>% mutate(group = "adult"),
child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender))%>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE)),
mins_r = (mins - min(mins, na.rm=TRUE)) / (max(mins, na.rm=TRUE) - min(mins, na.rm=TRUE)),
) %>%
ungroup()
# Standardize age globally
dall$age_r <- scale(dall$age)[,1]
model <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy_r ~ c(a1_adult, a1_child)*age_r + c(a2_adult, a2_child)*gender + eth
guilt_r ~ c(b1_adult, b1_child)*age_r + c(b2_adult, b2_child)*gender + eth
opp_r ~ c(c1_adult, c1_child)*age_r + eth
fit_r ~ c(d1_adult, d1_child)*age_r + eth
social_r ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins_r ~ c(e1_adult, e1_child)*enjoy_r +
c(e2_adult, e2_child)*guilt_r +
c(e3_adult, e3_child)*opp_r +
c(e4_adult, e4_child)*fit_r +
c(e5_adult, e5_child)*social_r +
eth
# Indirect effects via age
age_indirect_adult  := a1_adult*e1_adult + b1_adult*e2_adult
+ c1_adult*e3_adult + d1_adult*e4_adult
age_indirect_child  := a1_child*e1_child + b1_child*e2_child
+ c1_child*e3_child + d1_child*e4_child
# Indirect effects via gender
gender_indirect_adult := a2_adult*e1_adult + b2_adult*e2_adult
gender_indirect_child := a2_child*e1_child + b2_child*e2_child
# Total effects
age_total_adult   := age_indirect_adult
age_total_child   := age_indirect_child
gender_total_adult := gender_indirect_adult
gender_total_child := gender_indirect_child
'
fit <- sem(model, data = dall, group = "group")  # group = adult vs child
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
fitMeasures(fit, c("chisq","df","pvalue","cfi","tli","rmsea","srmr"), group = 1)  # first group
fitMeasures(fit, c("chisq","df","pvalue","cfi","tli","rmsea","srmr"), group = 2)  # first group
fitMeasures(fit, c("chisq","df","pvalue","cfi","tli","rmsea","srmr"), group = "adult")  # first group
fitMeasures(fit, c("chisq","df","pvalue","cfi","tli","rmsea","srmr"), group = "youth")  # first group
plot(dall$mins)
summary(dall$mins)
summary(child.trim$mins)
summary(adult.trim$mins)
summary(adult.var$DUR_MOD_SPORTCOUNT_A01)
summary(adult.var$DUR_HVY_SPORTCOUNT_A01)
summary(data.adult$DUR_HVY_SPORTCOUNT_A01)
child.trim <- child.var %>%
filter(Disab_All_POP == 2,
gend3 %in% c(1,2),
eth2 %in% c(1,2),
if_all(c(PL_Enjoy_bc_ans, MO_Fun_c, MO_Fit_c,
MO_Guilt_c, MO_Opp_c), ~ . < 6,),
if_all(c(PL_Enjoy_bc_ans, MO_Fun_c, MO_Fit_c,
MO_Guilt_c, MO_Opp_c,
Try_bc, PL_GdMe_bc_ans,
gend3, age_11,
mins_modplus_outschool_Week_ALL
), ~ .x > -1)) %>%
select(
enjoy=PL_Enjoy_bc_ans,
social=MO_Fun_c, #> 11yo only
fit=MO_Fit_c,
# try=Try_bc, #adult no data
guilt=MO_Guilt_c,
# know=PL_GdMe_bc_ans, #adult no data
opp=MO_Opp_c, # > 11yo only
gender=gend3,
age=age_11,
eth=eth2,
mins=mins_modplus_outschool_Week_ALL #this or all intensity?
)
adult.trim <- adult.var %>% filter(Disab2_POP==2,
Gend3 %in% c(1,2),
Eth2 %in% c(1,2),
if_all(c(Motiva_POP,motivex2c,motivex2a,
motivc_POP,READYOP1_POP,
Gend3,Age17,
DUR_MOD_SPORTCOUNT_A01,
DUR_HVY_SPORTCOUNT_A01
), ~ .x > -1)) %>%
mutate(mins=DUR_HVY_CAPPED_SPORTCOUNT_A01+DUR_MOD_CAPPED_SPORTCOUNT_A01) %>%
# ,eth=ifelse(Eth7==5, 3,
#            ifelse(Eth7==6, 5,
#                   ifelse(Eth7==7, 6, Eth7))))
select(
enjoy=Motiva_POP,
social=motivex2c,
fit=motivex2a,
# try=indevtry, #unsure why so many NAs, not included
guilt=motivc_POP,
# know=motive_POP, #unsure why so many NAs, not included
opp=READYOP1_POP,
gender=Gend3,
# gender2=gend2_GR6,
age=Age17,
eth=Eth2,
mins
)
dall <- bind_rows(
adult.trim %>% mutate(group = "adult"),
child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender),
mins = ifelse(mins > 1680, 1680, mins))%>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE)),
mins_r = (mins - min(mins, na.rm=TRUE)) / (max(mins, na.rm=TRUE) - min(mins, na.rm=TRUE)),
) %>%
ungroup()
# Standardize age globally
dall$age_r <- scale(dall$age)[,1]
model <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy_r ~ c(a1_adult, a1_child)*age_r + c(a2_adult, a2_child)*gender + eth
guilt_r ~ c(b1_adult, b1_child)*age_r + c(b2_adult, b2_child)*gender + eth
opp_r ~ c(c1_adult, c1_child)*age_r + eth
fit_r ~ c(d1_adult, d1_child)*age_r + eth
social_r ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins_r ~ c(e1_adult, e1_child)*enjoy_r +
c(e2_adult, e2_child)*guilt_r +
c(e3_adult, e3_child)*opp_r +
c(e4_adult, e4_child)*fit_r +
c(e5_adult, e5_child)*social_r +
eth
# Indirect effects via age
age_indirect_adult  := a1_adult*e1_adult + b1_adult*e2_adult
+ c1_adult*e3_adult + d1_adult*e4_adult
age_indirect_child  := a1_child*e1_child + b1_child*e2_child
+ c1_child*e3_child + d1_child*e4_child
# Indirect effects via gender
gender_indirect_adult := a2_adult*e1_adult + b2_adult*e2_adult
gender_indirect_child := a2_child*e1_child + b2_child*e2_child
# Total effects
age_total_adult   := age_indirect_adult
age_total_child   := age_indirect_child
gender_total_adult := gender_indirect_adult
gender_total_child := gender_indirect_child
'
fit <- sem(model, data = dall, group = "group")  # group = adult vs child
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
model <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy_r ~ c(a1_adult, a1_child)*age_r + c(a2_adult, a2_child)*gender + eth
guilt_r ~ c(b1_adult, b1_child)*age_r + c(b2_adult, b2_child)*gender + eth
opp_r ~ c(c1_adult, c1_child)*age_r + eth
fit_r ~ c(d1_adult, d1_child)*age_r + eth
social_r ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins ~ c(e1_adult, e1_child)*enjoy_r +
c(e2_adult, e2_child)*guilt_r +
c(e3_adult, e3_child)*opp_r +
c(e4_adult, e4_child)*fit_r +
c(e5_adult, e5_child)*social_r +
eth
# Indirect effects via age
age_indirect_adult  := a1_adult*e1_adult + b1_adult*e2_adult
+ c1_adult*e3_adult + d1_adult*e4_adult
age_indirect_child  := a1_child*e1_child + b1_child*e2_child
+ c1_child*e3_child + d1_child*e4_child
# Indirect effects via gender
gender_indirect_adult := a2_adult*e1_adult + b2_adult*e2_adult
gender_indirect_child := a2_child*e1_child + b2_child*e2_child
# Total effects
age_total_adult   := age_indirect_adult
age_total_child   := age_indirect_child
gender_total_adult := gender_indirect_adult
gender_total_child := gender_indirect_child
'
fit <- sem(model, data = dall, group = "group")  # group = adult vs child
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
table(dall$enjoy)
table(dall$enjoy, dall$group)
table(dall$enjoy_r, dall$group)
table(dall$guilt, dall$guilt_r, dall$group)
# Complete model -------------------------------------------------------------
model0 <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy ~ c(a1_adult, a1_child)*age + c(a2_adult, a2_child)*gender + eth
guilt ~ c(b1_adult, b1_child)*age + c(b2_adult, b2_child)*gender + eth
opp ~ c(c1_adult, c1_child)*age + eth
fit ~ c(d1_adult, d1_child)*age + eth
social ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins ~ c(e1_adult, e1_child)*enjoy +
c(e2_adult, e2_child)*guilt +
c(e3_adult, e3_child)*opp +
c(e4_adult, e4_child)*fit +
c(e5_adult, e5_child)*social +
eth
# Indirect effects via age
age_indirect_adult  := a1_adult*e1_adult + b1_adult*e2_adult
+ c1_adult*e3_adult + d1_adult*e4_adult
age_indirect_child  := a1_child*e1_child + b1_child*e2_child
+ c1_child*e3_child + d1_child*e4_child
# Indirect effects via gender
gender_indirect_adult := a2_adult*e1_adult + b2_adult*e2_adult
gender_indirect_child := a2_child*e1_child + b2_child*e2_child
# Total effects
age_total_adult   := age_indirect_adult
age_total_child   := age_indirect_child
gender_total_adult := gender_indirect_adult
gender_total_child := gender_indirect_child
'
fit <- sem(model0, data = dall, group = "group")
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
varTable(fit)
model <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy_r ~ c(a1_adult, a1_child)*age_r + c(a2_adult, a2_child)*gender + eth
guilt_r ~ c(b1_adult, b1_child)*age_r + c(b2_adult, b2_child)*gender + eth
opp_r ~ c(c1_adult, c1_child)*age_r + eth
fit_r ~ c(d1_adult, d1_child)*age_r + eth
social_r ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins ~ c(e1_adult, e1_child)*enjoy_r +
c(e2_adult, e2_child)*guilt_r +
c(e3_adult, e3_child)*opp_r +
c(e4_adult, e4_child)*fit_r +
c(e5_adult, e5_child)*social_r +
eth
# Indirect effects via age
age_indirect_adult  := a1_adult*e1_adult + b1_adult*e2_adult
+ c1_adult*e3_adult + d1_adult*e4_adult
age_indirect_child  := a1_child*e1_child + b1_child*e2_child
+ c1_child*e3_child + d1_child*e4_child
# Indirect effects via gender
gender_indirect_adult := a2_adult*e1_adult + b2_adult*e2_adult
gender_indirect_child := a2_child*e1_child + b2_child*e2_child
# Total effects
age_total_adult   := age_indirect_adult
age_total_child   := age_indirect_child
gender_total_adult := gender_indirect_adult
gender_total_child := gender_indirect_child
'
fit0 <- sem(model0, data = dall, group = "group")
fit <- sem(model, data = dall, group = "group")  # group = adult vs child
varTable(fit)
varTable(fit0)
model <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy_r ~ c(a1_adult, a1_child)*age_r + c(a2_adult, a2_child)*gender + eth
guilt_r ~ c(b1_adult, b1_child)*age_r + c(b2_adult, b2_child)*gender + eth
opp_r ~ c(c1_adult, c1_child)*age_r + eth
fit_r ~ c(d1_adult, d1_child)*age_r + eth
social_r ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins_r ~ c(e1_adult, e1_child)*enjoy_r +
c(e2_adult, e2_child)*guilt_r +
c(e3_adult, e3_child)*opp_r +
c(e4_adult, e4_child)*fit_r +
c(e5_adult, e5_child)*social_r +
eth
# Indirect effects via age
age_indirect_adult  := a1_adult*e1_adult + b1_adult*e2_adult
+ c1_adult*e3_adult + d1_adult*e4_adult
age_indirect_child  := a1_child*e1_child + b1_child*e2_child
+ c1_child*e3_child + d1_child*e4_child
# Indirect effects via gender
gender_indirect_adult := a2_adult*e1_adult + b2_adult*e2_adult
gender_indirect_child := a2_child*e1_child + b2_child*e2_child
# Total effects
age_total_adult   := age_indirect_adult
age_total_child   := age_indirect_child
gender_total_adult := gender_indirect_adult
gender_total_child := gender_indirect_child
'
fit <- sem(model, data = dall, group = "group")  # group = adult vs child
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
varTable(fit0)
varTable(fit)
dall <- bind_rows(
adult.trim %>% mutate(group = "adult"),
child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender),
mins = ifelse(mins > 1680, 1680, mins))%>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE)),
# mins_r = (mins - min(mins, na.rm=TRUE)) / (max(mins, na.rm=TRUE) - min(mins, na.rm=TRUE)),
dall$age_r <- scale(dall$age)[,1]
) %>%
ungroup()
dall$mins_r <- (dall$mins - min(dall$mins, na.rm=TRUE)) / (max(dall$mins, na.rm=TRUE) - min(dall$mins, na.rm=TRUE))
dall <- bind_rows(
adult.trim %>% mutate(group = "adult"),
child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender),
mins = ifelse(mins > 1680, 1680, mins))%>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE)),
# mins_r = (mins - min(mins, na.rm=TRUE)) / (max(mins, na.rm=TRUE) - min(mins, na.rm=TRUE)),
dall$age_r <- (dall$age - min(dall$age, na.rm=TRUE)) / (max(dall$age, na.rm=TRUE) - min(dall$age, na.rm=TRUE))
) %>%
ungroup()
dall <- bind_rows(
adult.trim %>% mutate(group = "adult"),
child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender),
mins = ifelse(mins > 1680, 1680, mins))%>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE)),
# mins_r = (mins - min(mins, na.rm=TRUE)) / (max(mins, na.rm=TRUE) - min(mins, na.rm=TRUE)),
age_r <- (dall$age - min(dall$age, na.rm=TRUE)) / (max(dall$age, na.rm=TRUE) - min(dall$age, na.rm=TRUE))
) %>%
ungroup()
dall <- bind_rows(
adult.trim %>% mutate(group = "adult"),
child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender),
mins = ifelse(mins > 1680, 1680, mins))%>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE)),
# mins_r = (mins - min(mins, na.rm=TRUE)) / (max(mins, na.rm=TRUE) - min(mins, na.rm=TRUE)),
age_r = (dall$age - min(dall$age, na.rm=TRUE)) / (max(dall$age, na.rm=TRUE) - min(dall$age, na.rm=TRUE))
) %>%
ungroup()
dall <- bind_rows(
adult.trim %>% mutate(group = "adult"),
child.trim %>% mutate(group = "youth")
) %>%
mutate(across(c(enjoy, social, fit, opp, guilt), ~ 6 - .),
eth = as.factor(eth),
gender = as.factor(gender),
mins = ifelse(mins > 1680, 1680, mins))%>%
group_by(group) %>%
mutate(
enjoy_r  = (enjoy - min(enjoy, na.rm=TRUE)) / (max(enjoy, na.rm=TRUE) - min(enjoy, na.rm=TRUE)),
guilt_r  = (guilt - min(guilt, na.rm=TRUE)) / (max(guilt, na.rm=TRUE) - min(guilt, na.rm=TRUE)),
opp_r    = (opp - min(opp, na.rm=TRUE)) / (max(opp, na.rm=TRUE) - min(opp, na.rm=TRUE)),
fit_r    = (fit - min(fit, na.rm=TRUE)) / (max(fit, na.rm=TRUE) - min(fit, na.rm=TRUE)),
social_r = (social - min(social, na.rm=TRUE)) / (max(social, na.rm=TRUE) - min(social, na.rm=TRUE)),
# mins_r = (mins - min(mins, na.rm=TRUE)) / (max(mins, na.rm=TRUE) - min(mins, na.rm=TRUE)),
age_r = (age - min(age, na.rm=TRUE)) / (max(age, na.rm=TRUE) - min(age, na.rm=TRUE))
) %>%
ungroup()
dall$mins_r <- (dall$mins - min(dall$mins, na.rm=TRUE)) / (max(dall$mins, na.rm=TRUE) - min(dall$mins, na.rm=TRUE))
# Complete model -------------------------------------------------------------
model0 <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy ~ c(a1_adult, a1_child)*age + c(a2_adult, a2_child)*gender + eth
guilt ~ c(b1_adult, b1_child)*age + c(b2_adult, b2_child)*gender + eth
opp ~ c(c1_adult, c1_child)*age + eth
fit ~ c(d1_adult, d1_child)*age + eth
social ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins ~ c(e1_adult, e1_child)*enjoy +
c(e2_adult, e2_child)*guilt +
c(e3_adult, e3_child)*opp +
c(e4_adult, e4_child)*fit +
c(e5_adult, e5_child)*social +
eth
# Indirect effects via age
age_indirect_adult  := a1_adult*e1_adult + b1_adult*e2_adult
+ c1_adult*e3_adult + d1_adult*e4_adult
age_indirect_child  := a1_child*e1_child + b1_child*e2_child
+ c1_child*e3_child + d1_child*e4_child
# Indirect effects via gender
gender_indirect_adult := a2_adult*e1_adult + b2_adult*e2_adult
gender_indirect_child := a2_child*e1_child + b2_child*e2_child
# Total effects
age_total_adult   := age_indirect_adult
age_total_child   := age_indirect_child
gender_total_adult := gender_indirect_adult
gender_total_child := gender_indirect_child
'
model <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy_r ~ c(a1_adult, a1_child)*age_r + c(a2_adult, a2_child)*gender + eth
guilt_r ~ c(b1_adult, b1_child)*age_r + c(b2_adult, b2_child)*gender + eth
opp_r ~ c(c1_adult, c1_child)*age_r + eth
fit_r ~ c(d1_adult, d1_child)*age_r + eth
social_r ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins_r ~ c(e1_adult, e1_child)*enjoy_r +
c(e2_adult, e2_child)*guilt_r +
c(e3_adult, e3_child)*opp_r +
c(e4_adult, e4_child)*fit_r +
c(e5_adult, e5_child)*social_r +
eth
# Indirect effects via age
age_indirect_adult  := a1_adult*e1_adult + b1_adult*e2_adult
+ c1_adult*e3_adult + d1_adult*e4_adult
age_indirect_child  := a1_child*e1_child + b1_child*e2_child
+ c1_child*e3_child + d1_child*e4_child
# Indirect effects via gender
gender_indirect_adult := a2_adult*e1_adult + b2_adult*e2_adult
gender_indirect_child := a2_child*e1_child + b2_child*e2_child
# Total effects
age_total_adult   := age_indirect_adult
age_total_child   := age_indirect_child
gender_total_adult := gender_indirect_adult
gender_total_child := gender_indirect_child
'
fit0 <- sem(model0, data = dall, group = "group")
fit <- sem(model, data = dall, group = "group")  # group = adult vs child
summary(fit0, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
m0 <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy ~ age + gender + eth
guilt ~ age + gender + eth
opp ~ age + eth
fit ~ age + eth
social ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins ~ enjoy +guilt +opp +fit +social +eth
'
m0 <- '
# Mediators: age and gender predicting motives, controlling for ethnicity
enjoy_r ~ age_r + gender + eth
guilt ~ age_r + gender + eth
opp_r ~ age_r + eth
fit_r ~ age_r + eth
social_r ~ eth
# Main outcome: motives predicting mins, controlling for ethnicity
mins_r ~ enjoy_r +guilt_r +opp_r +fit_r +social_r +eth
'
f0 <- sem(m0, data = dall, group = "group", meanstructure = TRUE)
summary(f0, fit.measures = TRUE, standardized = TRUE)
f0 <- sem(m0, data = dall, group = "group")
summary(f0, fit.measures = TRUE, standardized = TRUE)
# Constrain all to be equal
f.con <- sem(m0, dall, group = "group",
group.equal = c("intercepts", "regressions"))
summary(fit.con)
summary(f.con)
install.packages("piecewiseSEM")
