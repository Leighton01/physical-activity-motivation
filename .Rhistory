Weighted.Median = wmed.ad,
Weighted.Q25 = wq25.ad,
Weighted.Q75 = wq75.ad
)
mins.adult
gg.mins.ad <- ggplot(mins.adult, aes(x = factor(Class), y = Weighted.Median)) +
geom_point(size = 3, color = "blue") +                 # median as a point
geom_errorbar(aes(ymin = Weighted.Q25, ymax = Weighted.Q75),
width = 0.2, color = "darkblue") +      # IQR as error bars
labs(x = "Class", y = "Minutes (Weighted Median Â± IQR)",
title = "Weighted Median and IQR per Class") +
theme_minimal()
gg.mins.ad
# Predictor plot
plot(LCAE.ad, nclass = 2)
# Bootstrap Vuong-Lo-Mendell-Rubin Likelihood Ratio Test
# 100 reps
blrt.ad
or.ad
or.ci.ad
sum.fit.ad <- summary(fit.ad)
se <- sum.fit.ad$standard.errors
se.ad <- sum.fit.ad$standard.errors
# Coefficients
coefs.ad <- coef(fit.ad)
# 95% CI for odds ratios
ci.l.ad <- exp(coefs.ad - 1.96 * se.ad)
ci.u.ad <- exp(coefs.ad + 1.96 * se.ad)
# Combine into a table
or.ci.ad <- data.frame(
CI.lower = round(ci.l.ad, 3),
CI.upper = round(ci.u.ad, 3)
)
colnames(or.ci.ad) <- c("Intercept.L", "Age2.L", "Age3.L", "Age4.L",
"Age5.L","Age6.L","Intercept.U","Age2.U", "Age3.U", "Age4.U",
"Age5.U","Age6.U")
tb.byage.ad <- adild.lik %>%
count(age, class) %>%
pivot_wider(names_from = class, values_from = n, values_fill = 0)
tb.byage.ad <- adult.lik %>%
count(age, class) %>%
pivot_wider(names_from = class, values_from = n, values_fill = 0)
tb.byage.ad
or.ci.ad
or.ad
tb.byage.ad
gg.byage.ad <- adult.lik %>%
count(age, class) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(class))) +
geom_col() +
labs(x = "Age group", y = "Proportion", fill = "Class") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
gg.byage.ad
colnames(child.lik)
adult.lik %>%
count(age, fit) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(fit))) +
geom_col() +
labs(x = "Age group", y = "Proportion", fill = "Class") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
adult.lik %>%
count(age, fit) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(fit))) +
geom_col() +
labs(x = "Age group", y = "Fitness", fill = "Class") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
adult.lik %>%
count(age, fit) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(fit))) +
geom_col() +
labs(x = "Age group", y = "Fitness", fill = "Score") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
adult.lik %>%
count(age, relx) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(relx))) +
geom_col() +
labs(x = "Age group", y = "Fitness", fill = "Score") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
adult.lik %>%
count(age, enjoy) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(enjoy))) +
geom_col() +
labs(x = "Age group", y = "Fitness", fill = "Score") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
adult.lik %>%
count(age, relx) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(relx))) +
geom_col() +
labs(x = "Age group", y = "Fitness", fill = "Score") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
adult.lik %>%
count(age, social) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(social))) +
geom_col() +
labs(x = "Age group", y = "Fitness", fill = "Score") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
adult.lik %>%
count(age, social) %>%
group_by(age) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(x = factor(age), y = prop, fill = factor(social))) +
geom_col() +
labs(x = "Age group", y = "Fitness", fill = "Score") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
library(scales)
vars.ad <- setdiff(names(adult.lik), c("age","mins","post","class"))
vars.ad
vars.ad <- setdiff(names(adult.lik), c("age","mins","post","class",
"gender","eth","edu"))
vars.ad
adult.lik_long <- adult.lik %>%
pivot_longer(cols = all_of(vars.ad), names_to = "variable", values_to = "score") %>%
count(age, variable, score) %>%
group_by(age, variable) %>%
mutate(prop = n / sum(n))
ggplot(adult.lik_long, aes(x = factor(age), y = prop, fill = factor(score))) +
geom_col() +
facet_wrap(~variable, nrow = 3, ncol = 3) +
labs(x = "Age group", y = "Proportion", fill = "Score") +
scale_y_continuous(labels = percent_format()) +
theme_minimal() +
theme(legend.position = "bottom")
gg.vars.ad <- ggplot(adult.lik_long, aes(x = factor(age), y = prop, fill = factor(score))) +
geom_col() +
facet_wrap(~variable, nrow = 3, ncol = 3) +
labs(x = "Age group", y = "Proportion", fill = "Score") +
scale_y_continuous(labels = percent_format()) +
theme_minimal() +
theme(legend.position = "bottom")
gg.byage.ch
vars.ch <- setdiff(names(child.lik), c("age","mins","post","class",
"gender","eth","edu"))
child.lik_long <- child.lik %>%
pivot_longer(cols = all_of(vars.ch), names_to = "variable", values_to = "score") %>%
count(age, variable, score) %>%
group_by(age, variable) %>%
mutate(prop = n / sum(n))
gg.vars.ch <- ggplot(child.lik_long, aes(x = factor(age), y = prop, fill = factor(score))) +
geom_col() +
facet_wrap(~variable, nrow = 3, ncol = 3) +
labs(x = "Age group", y = "Proportion", fill = "Score") +
scale_y_continuous(labels = percent_format()) +
theme_minimal() +
theme(legend.position = "bottom")
gg.vars.ch
gg.vars.ad
child.lik_long
Multinomial logistic regression examined the association between age and motivation profile, with the highly motivated class (Class 1) as the reference. Compared with the youngest adults (age1), older age groups had higher odds of being in the moderate (Class 3) or low motivation (Class 2) classes. The effect was strongest in the oldest group (age6), who were about twice as likely to belong to the low motivation class (OR = 2.06) and 1.84 times more likely to belong to the moderate motivation class, relative to the highly motivated class. These results indicate that motivation tends to decline with age, with fewer older adults exhibiting the highly positive/intrinsic profile.
plot(LCAE.ad, nclass = 2)
gg.byage.ad
gg.byage.ad
cohen
f0
summary(f0)
summary(fit0)
sem.free
# # Check effect size of each variable
#
# cohen.enj <- cohen_d_lavaan(f0, "enjoyb")
# cohen.soc <- cohen_d_lavaan(f0, "socialb")
# cohen.fit <- cohen_d_lavaan(f0, "fitb")
# cohen.glt <- cohen_d_lavaan(f0, "guiltb")
# cohen.opp <- cohen_d_lavaan(f0, "oppb")
#
#
#
cohen_d_slope <- function(model, param_name) {
# 1. Extract slope estimates and SEs
slopes <- parameterEstimates(model, standardized = FALSE)
slopes_path <- slopes %>%
filter(lhs == "mins", rhs == param_name)
slope_adult <- slopes_path$est[slopes_path$group == 1]
slope_youth <- slopes_path$est[slopes_path$group == 2]
se_adult <- slopes_path$se[slopes_path$group == 1]
se_youth <- slopes_path$se[slopes_path$group == 2]
# 2. Standardized difference of slopes (like z-score)
se_diff <- sqrt(se_adult^2 + se_youth^2)
d_slope <- (slope_youth - slope_adult) / se_diff
# 3. Optional: return slope difference in minutes too
slope_diff <- slope_youth - slope_adult
return(list(
d_slope = d_slope,
slope_diff = slope_diff
))
}
cohen_d_slope(f0,enjoyb)
parameterEstimates
?parameterEstimates
library(lavaan)
# # Check effect size of each variable
#
# cohen.enj <- cohen_d_lavaan(f0, "enjoyb")
# cohen.soc <- cohen_d_lavaan(f0, "socialb")
# cohen.fit <- cohen_d_lavaan(f0, "fitb")
# cohen.glt <- cohen_d_lavaan(f0, "guiltb")
# cohen.opp <- cohen_d_lavaan(f0, "oppb")
#
#
#
cohen_d_slope <- function(model, param_name) {
# 1. Extract slope estimates and SEs
slopes <- parameterEstimates(model, standardized = FALSE)
slopes_path <- slopes %>%
filter(lhs == "mins", rhs == param_name)
slope_adult <- slopes_path$est[slopes_path$group == 1]
slope_youth <- slopes_path$est[slopes_path$group == 2]
se_adult <- slopes_path$se[slopes_path$group == 1]
se_youth <- slopes_path$se[slopes_path$group == 2]
# 2. Standardized difference of slopes (like z-score)
se_diff <- sqrt(se_adult^2 + se_youth^2)
d_slope <- (slope_youth - slope_adult) / se_diff
# 3. Optional: return slope difference in minutes too
slope_diff <- slope_youth - slope_adult
return(list(
d_slope = d_slope,
slope_diff = slope_diff
))
}
cohen_d_slope(f0,enjoyb)
slopes <- parameterEstimates(model, standardized = FALSE)
slopes <- parameterEstimates(f0, standardized = FALSE)
slopes
cohen_d_slope(f0,"enjoyb")
cohen_d_slope(f0,"fitb")
cohen_d_slope(f0,"oppb")
summary(f0)
slopes_path
slopes_path
slopes
f0
summary(f0)
# Filter for paths predicting 'mins'
slopes <- params %>%
filter(lhs == "mins", op == "~") %>%
select(rhs, group, est, se)
params
params <- parameterEstimates(sem.free, standardized = FALSE)
# Put slope diff. in a table
params <- parameterEstimates(sem.free, standardized = FALSE)
# Filter for paths predicting 'mins'
slopes <- params %>%
filter(lhs == "mins", op == "~") %>%
select(rhs, group, est, se)
# Put slope diff. in a table
params <- parameterEstimates(sem.free, standardized = FALSE)
# Filter for paths predicting 'mins'
slopes <- params %>%
filter(lhs == "mins", op == "~") %>%
select(rhs, group, est, se)
params
# Put slope diff. in a table
params <- parameterEstimates(sem.free, standardized = FALSE)
# Put slope diff. in a table
params <- parameterEstimates(f0, standardized = FALSE)
# Filter for paths predicting 'mins'
slopes <- params %>%
filter(lhs == "mins", op == "~") %>%
select(rhs, group, est, se)
params
# Filter for paths predicting 'mins'
slopes <- params %>%
filter(lhs == "mins", op == "~") %>%
select(rhs, group, est, se)
# Filter for paths predicting 'mins'
slopes <- params %>%
filter(lhs == "mins", op == "~") %>%
dplyr::select(rhs, group, est, se)
slopes_youth <- slopes %>% filter(group == 2) %>% select(rhs, est_youth = est, se_youth = se)
slopes.ad <- slopes %>% filter(group == 1) %>%
select(rhs, est_adult = est, se_adult = se)
slopes.ad <- slopes %>% filter(group == 1) %>%
dplyr::select(rhs, est.adult = est, se.adult = se)
slopes.ch <- slopes %>% filter(group == 2) %>%
dplyr::select(rhs, est.youth = est, se.youth = se)
slopes.diff <- left_join(slopes_adult, slopes_youth, by = "rhs")
slopes.ad <- slopes %>% filter(group == 1) %>%
dplyr::select(rhs, est.adult = est, se.adult = se)
slopes.ch <- slopes %>% filter(group == 2) %>%
dplyr::select(rhs, est.youth = est, se.youth = se)
slopes.diff <- left_join(slopes.ad, slopes.ch, by = "rhs")
slopes.diff
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult,
se.diff = sqrt(se.adult^2 + se.youth^2),
z = diff / se.diff,
p = 2 * (1 - pnorm(abs(z)))
)
slopes_diff
slopes.diff
# filter
slopes <- params %>%
filter(lhs == "mins", op == "~") %>%
dplyr::select(var=rhs, group, est, se)
# filtre more
slopes.ad <- slopes %>% filter(group == 1) %>%
dplyr::select(var, est.adult = est, se.adult = se)
slopes.ch <- slopes %>% filter(group == 2) %>%
dplyr::select(var, est.youth = est, se.youth = se)
# join!
slopes.diff <- left_join(slopes.ad, slopes.ch, by = "rhs")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult,
se.diff = sqrt(se.adult^2 + se.youth^2),
z = diff / se.diff,
p = 2 * (1 - pnorm(abs(z)))
)
# join!
slopes.diff <- left_join(slopes.ad, slopes.ch, by = "rhs")
# join!
slopes.diff <- left_join(slopes.ad, slopes.ch, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult,
se.diff = sqrt(se.adult^2 + se.youth^2),
z = diff / se.diff,
p = 2 * (1 - pnorm(abs(z)))
)
slopes.diff
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult,
se.diff = sqrt(se.adult^2 + se.youth^2),
z = diff / se.diff,
p = 2 * (1 - pnorm(abs(z)))
) %>%
dplyr::select(-z, -p)
slopes.diff
# Put slope diff. in a table
params <- parameterEstimates(f0, standardized = T)
# filter
slopes <- params %>%
filter(lhs == "mins", op == "~") %>%
dplyr::select(var=rhs, group, est, se)
# filtre more
slopes.ad <- slopes %>% filter(group == 1) %>%
dplyr::select(var, est.adult = est, se.adult = se)
slopes.ch <- slopes %>% filter(group == 2) %>%
dplyr::select(var, est.youth = est, se.youth = se)
# join!
slopes.diff <- left_join(slopes.ad, slopes.ch, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult,
se.diff = sqrt(se.adult^2 + se.youth^2),
z = diff / se.diff,
p = 2 * (1 - pnorm(abs(z)))
) %>%
dplyr::select(-z, -p)
slopes.diff
slopes
params
# join!
slopes.diff <- left_join(slopes.ch, slopes.ad, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult,
se.diff = sqrt(se.adult^2 + se.youth^2),
z = diff / se.diff,
p = 2 * (1 - pnorm(abs(z)))
) %>%
dplyr::select(-z, -p)
slopes.diff
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult,
se.diff = sqrt(se.adult^2 + se.youth^2),
z = diff / se.diff,
p = 2 * (1 - pnorm(abs(z)))
)
slopes.diff
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
)
slopes.diff
# join!
slopes.diff <- left_join(slopes.ch, slopes.ad, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
)
slopes.diff <- data.frame()
# join!
slopes.diff <- left_join(slopes.ch, slopes.ad, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
)
slopes.diff
# join!
slopes.diff <- data.frame()
slopes.diff <- left_join(slopes.ch, slopes.ad, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
) %>%
dplyr::select(-se.youth, -se.adult)
slopes.diff
# join!
slopes.diff <- data.frame()
slopes.diff <- left_join(slopes.ch, slopes.ad, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
) %>%
filter(-gender,-eth) %>%
dplyr::select(-se.youth, -se.adult)
# join!
slopes.diff <- data.frame()
slopes.diff <- left_join(slopes.ch, slopes.ad, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
) %>%
filter(var %in% !c(-gender,-eth)) %>%
dplyr::select(-se.youth, -se.adult)
# join!
slopes.diff <- data.frame()
slopes.diff <- left_join(slopes.ch, slopes.ad, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
) %>%
filter(!var %in% c(-gender,-eth)) %>%
dplyr::select(-se.youth, -se.adult)
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
) %>%
filter(!var %in% c(gender,eth)) %>%
dplyr::select(-se.youth, -se.adult)
slopes.diff
# join!
slopes.diff <- data.frame()
slopes.diff <- left_join(slopes.ch, slopes.ad, by = "var")
# calculate
slopes.diff <- slopes.diff %>%
mutate(
diff = est.youth - est.adult
# se.diff = sqrt(se.adult^2 + se.youth^2),
# z = diff / se.diff,
# p = 2 * (1 - pnorm(abs(z)))
) %>%
filter(!var %in% c("gender","eth")) %>%
dplyr::select(-se.youth, -se.adult)
slopes.diff
