prop.table(table(adult.lik$class))
mins.adult
unique(child.lik$age
)
child.lik <- child.var %>%
# 1-4, 1=strong agree, 4=strong disagree, 5=can't say
dplyr::select(enjoy=PL_Enjoy_bc_ans,
social=MO_Fun_c,
fit=MO_Fit_c,
try=Try_bc,
guilt=MO_Guilt_c, #99 instead of 5 for "can't say"
know=PL_GdMe_bc_ans,
opp=MO_Opp_c, #99 instead of 5 for "can't say"
conf=PL_Conf_bc_ans,
easy=PL_Easy_bc_ans,
more=Exeramt_bc, #only 3, 1=more,2=same,3=less
dsbl=Disab_All_POP,
gender=gend3,
age=age_11,
eth=eth2,
mins=mins_modplus_outschool_Week_ALL
) %>%
filter(dsbl == 2,
gender %in% c(1,2),
eth %in% c(1,2),
mins > -1,
if_all(c(enjoy,social,fit,guilt,opp,know,try,conf,easy,more),
~ .x > -1 & .x < 5)) %>%
mutate(
mins = ifelse(mins > 1680, 1680, mins),
across(c(conf,easy,enjoy,fit,know,more,opp,try),
~ case_when(.x==4~3L, TRUE ~ as.integer(.x))),
age=age-10
) %>%
dplyr::select(-dsbl)
child.lik.back <- child.lik
adult.lik <- adult.var %>%
mutate(mins=DUR_HVY_CAPPED_SPORTCOUNT_A01+DUR_MOD_CAPPED_SPORTCOUNT_A01) %>%
# 1=strong agree, 5=strong disagree
dplyr::select(enjoy=Motiva_POP,
social=motivex2c,
fit=motivex2a,
guilt=motivc_POP,
opp=READYOP1_POP,
imp=motivb_POP,
dis=motivd_POP, #disappoint
abil=READYAB1_POP, #ability
relx=motivex2b,
chal=motivex2d,
dsbl=Disab2_POP,
gender=Gend3,
age=AgeTGC,
eth=Eth2,
edu=Educ6,
mins
) %>%
filter(dsbl==2,
if_all(c(gender,eth), ~ .x %in% c(1,2)),
if_all(everything(), ~ .x > -1),
edu != 5
) %>%
mutate(dis = 6 - dis,
across(c(abil,chal,enjoy,fit,guilt,imp,opp,relx,dis),
~ case_when(.x==5~4L, TRUE ~ as.integer(.x))),
edu = case_when(edu==6~5L, TRUE~edu),
age=age-2
) %>%
dplyr::select(-dsbl)
adult.lik.back <- adult.lik
unique(child.lik$age
)
child.lik$age <- relevel(factor(child.lik$age), ref = "1")
child.lik$class <- relevel(factor(child.lik$class), ref = "3")
# pick best model
lca.best.ch <- poLCA.child[[3]]
# check class size (need >0.5 per)
child.lik$class <- lca.best.ch$predclass
table(child.lik$class)  # modal assignment
# INDIVIDUAL CLASSES
# 3, 5, or 6
lca.best.ad <- poLCA.adult[[3]]
# check class size (>0.5 per)
adult.lik$class <- lca.best.ad$predclass
# table(adult.lik$class)  # modal assignment
prop.table(table(adult.lik$class))
child.lik$class <- relevel(factor(child.lik$class), ref = "3")
child.lik$gender <- relevel(factor(child.lik$gender), ref = "1")
child.lik$eth <- relevel(factor(child.lik$eth), ref = "1")
child.lik$age <- relevel(factor(child.lik$age), ref = "1")
fit.ch <- multinom(class ~ age + gender + eth,
data = child.lik %>%
dplyr::select(-post,-mins))
fit.ch <- multinom(class ~ age + gender + eth,
data = child.lik %>%
dplyr::select(-mins))
or.ch <- exp(coef(fit.ch))
or.ch
adult.lik$age <- adult.lik.back$age
adult.lik$gender <- adult.lik.back$gender
adult.lik$eth <- adult.lik.back$eth
adult.lik$edu <- adult.lik.back$edu
adult.lik$class <- relevel(factor(adult.lik$class), ref = "3")
adult.lik$gender <- relevel(factor(adult.lik$gender), ref = "1")
adult.lik$eth <- relevel(factor(adult.lik$eth), ref = "1")
adult.lik$age <- relevel(factor(adult.lik$age), ref = "1")
adult.lik$edu <- relevel(factor(adult.lik$edu), ref = "1")
fit.ad <- multinom(class ~ age + edu + gender + eth,
data = adult.lik %>%
dplyr::select(-post,-mins))
fit.ad <- multinom(class ~ age + edu + gender + eth,
data = adult.lik %>%
dplyr::select(-mins))
summary(fit.ad)
# Odds ratios for easier interpretation
exp(coef(fit.ad))
or.ad <- exp(coef(fit.ad))
or.ch
or.ad
adult.lik <- adult.var %>%
mutate(mins=DUR_HVY_CAPPED_SPORTCOUNT_A01+DUR_MOD_CAPPED_SPORTCOUNT_A01) %>%
# 1=strong agree, 5=strong disagree
dplyr::select(enjoy=Motiva_POP,
social=motivex2c,
fit=motivex2a,
guilt=motivc_POP,
opp=READYOP1_POP,
imp=motivb_POP,
dis=motivd_POP, #disappoint
abil=READYAB1_POP, #ability
relx=motivex2b,
chal=motivex2d,
dsbl=Disab2_POP,
gender=Gend3,
age=AgeTGC,
eth=Eth2,
edu=Educ6,
mins
) %>%
filter(dsbl==2,
if_all(c(gender,eth), ~ .x %in% c(1,2)),
if_all(everything(), ~ .x > -1),
edu != 5
) %>%
mutate(dis = 6 - dis,
across(c(abil,chal,enjoy,fit,guilt,imp,opp,relx,dis),
~ case_when(.x==5~4L, TRUE ~ as.integer(.x))),
edu = case_when(edu==6~5L, TRUE~edu)
) %>%
dplyr::select(-dsbl)
adult.lik.back <- adult.lik
adult.lik$age <- adult.lik.back$age
adult.lik$gender <- adult.lik.back$gender
adult.lik$eth <- adult.lik.back$eth
adult.lik$edu <- adult.lik.back$edu
adult.lik$class <- relevel(factor(adult.lik$class), ref = "3")
adult.lik$gender <- relevel(factor(adult.lik$gender), ref = "1")
adult.lik$eth <- relevel(factor(adult.lik$eth), ref = "1")
# INDIVIDUAL CLASSES
# 3, 5, or 6
lca.best.ad <- poLCA.adult[[3]]
# check class size (>0.5 per)
adult.lik$class <- lca.best.ad$predclass
# table(adult.lik$class)  # modal assignment
prop.table(table(adult.lik$class))
# entropy, <0.8 good, higher != better
post.ad <- lca.best.ad$posterior
N <- nrow(post.ad)
C <- ncol(post.ad)
entro.ad <- 1 + (1/(N*log(C))) * sum(post.ad * log(post.ad))
entro.ad  # ranges 0â€“1, higher = better separation
# check each class prob
adult.lik$post <- apply(lca.best.ad$posterior, 1, max)
adult.lik$age <- adult.lik.back$age
adult.lik$gender <- adult.lik.back$gender
adult.lik$eth <- adult.lik.back$eth
adult.lik$edu <- adult.lik.back$edu
adult.lik$class <- relevel(factor(adult.lik$class), ref = "3")
adult.lik$gender <- relevel(factor(adult.lik$gender), ref = "1")
adult.lik$eth <- relevel(factor(adult.lik$eth), ref = "1")
adult.lik$age <- relevel(factor(adult.lik$age), ref = "1")
adult.lik$edu <- relevel(factor(adult.lik$edu), ref = "1")
fit.ad <- multinom(class ~ age + edu + gender + eth,
data = adult.lik %>%
dplyr::select(-post,-mins))
summary(fit.ad)
# Odds ratios for easier interpretation
exp(coef(fit.ad))
or.ch
prop.table(table(adult.var$Age17))
prop.table(table(adult.var$Age17))*100
prop.table(table(adult.var$AgeTGC))*100
prop.table(table(adult.var$Age5))*100
prop.table(table(adult.var$Age5_2))*100
# Odds ratios for easier interpretation
(coef(fit.ad)
coef(fit.ad)
prop.table(table(adult.lik$class))
mins.adult
or.ch
prop.table(table(child.lik$class))
mins.child
prop.table(table(adult.var$Age5))
prop.table(table(adult.var$Age5_2))
prop.table(table(adult.var$Age17))
prop.table(table(adult.var$Age9))
adult.lik <- adult.var %>%
mutate(mins=DUR_HVY_CAPPED_SPORTCOUNT_A01+DUR_MOD_CAPPED_SPORTCOUNT_A01) %>%
# 1=strong agree, 5=strong disagree
dplyr::select(enjoy=Motiva_POP,
social=motivex2c,
fit=motivex2a,
guilt=motivc_POP,
opp=READYOP1_POP,
imp=motivb_POP,
dis=motivd_POP, #disappoint
abil=READYAB1_POP, #ability
relx=motivex2b,
chal=motivex2d,
dsbl=Disab2_POP,
gender=Gend3,
age=Age9,
eth=Eth2,
edu=Educ6,
mins
) %>%
filter(dsbl==2,
if_all(c(gender,eth), ~ .x %in% c(1,2)),
if_all(everything(), ~ .x > -1),
edu != 5
) %>%
mutate(dis = 6 - dis,
across(c(abil,chal,enjoy,fit,guilt,imp,opp,relx,dis),
~ case_when(.x==5~4L, TRUE ~ as.integer(.x))),
edu = case_when(edu==6~5L, TRUE~edu),
) %>%
dplyr::select(-dsbl)
adult.lik.back <- adult.lik
# check class size (>0.5 per)
adult.lik$class <- lca.best.ad$predclass
# check each class prob
adult.lik$post <- apply(lca.best.ad$posterior, 1, max)
unique(adult.lik$age)
adult.lik$age <- adult.lik %>% mutate(age=case_when(age==2~3,age==9~8),
age=age-2)
adult.lik$age <- relevel(factor(adult.lik$age), ref = "1")
adult.lik$age <- relevel(factor(adult.lik$age), ref = 1)
unique(adult.lik$age)
adult.lik <- adult.var %>%
mutate(mins=DUR_HVY_CAPPED_SPORTCOUNT_A01+DUR_MOD_CAPPED_SPORTCOUNT_A01) %>%
# 1=strong agree, 5=strong disagree
dplyr::select(enjoy=Motiva_POP,
social=motivex2c,
fit=motivex2a,
guilt=motivc_POP,
opp=READYOP1_POP,
imp=motivb_POP,
dis=motivd_POP, #disappoint
abil=READYAB1_POP, #ability
relx=motivex2b,
chal=motivex2d,
dsbl=Disab2_POP,
gender=Gend3,
age=Age9,
eth=Eth2,
edu=Educ6,
mins
) %>%
filter(dsbl==2,
if_all(c(gender,eth), ~ .x %in% c(1,2)),
if_all(everything(), ~ .x > -1),
edu != 5
) %>%
mutate(dis = 6 - dis,
across(c(abil,chal,enjoy,fit,guilt,imp,opp,relx,dis),
~ case_when(.x==5~4L, TRUE ~ as.integer(.x))),
edu = case_when(edu==6~5L, TRUE~edu),
) %>%
dplyr::select(-dsbl)
adult.lik.back <- adult.lik
# INDIVIDUAL CLASSES
# 3, 5, or 6
lca.best.ad <- poLCA.adult[[3]]
# check class size (>0.5 per)
adult.lik$class <- lca.best.ad$predclass
# check each class prob
adult.lik$post <- apply(lca.best.ad$posterior, 1, max)
adult.lik$age <- adult.lik %>% mutate(age=case_when(age==2~3,age==9~8,TRUE~age),
age=age-2)
adult.lik$age <- relevel(factor(adult.lik$age), ref = 1)
unique(adult.lik$age)
adult.lik$age <- adult.lik.back$age
adult.lik$age <- adult.lik %>% dplyr::mutate(age=case_when(age==2~3L,
age==9~8L,TRUE~age),
age=as.integer(age-2))
adult.lik$age <- relevel(factor(adult.lik$age), ref = 1)
adult.lik$age <- adult.lik.back$age
adult.lik$age <- adult.lik %>% dplyr::mutate(age=case_when(age==2~3L,
age==9~8L,
TRUE~as.integer(age)),
age=as.integer(age-2))
adult.lik$age <- relevel(factor(adult.lik$age), ref = 1)
adult.lik$gender <- relevel(factor(adult.lik$gender), ref = "1")
str(adult.lik)
unique(adult.lik$age)
table(adult.lik$age)
adult.lik$age <- adult.lik.back$age
table(adult.lik$age)
adult.lik$age <- adult.lik.back$age
adult.lik <- adult.lik %>% mutate(age=case_when(age==2~3L,
age==9~8L,
TRUE~as.integer(age)),
age=as.integer(age-2))
adult.lik$age <- relevel(factor(adult.lik$age), ref = 1)
fit.ad <- multinom(class ~ age + edu + gender + eth,
data = adult.lik %>%
dplyr::select(-post,-mins))
summary(fit.ad)
# Odds ratios for easier interpretation
exp(coef(fit.ad))
adult.bi <- adult.var %>% filter(Disab2_POP==2,
Gend3 %in% c(1,2),
Eth2 %in% c(1,2),
if_all(c(AgeTGC,
DUR_MOD_CAPPED_SPORTCOUNT_A01,
DUR_HVY_CAPPED_SPORTCOUNT_A01),
~ .x > -1),
if_all(c(Motiva_POP_GR2, motivex2c_GR2,
motivex2a_GR2, motivc_POP_GR2,
READYOP1_POP_GR2),
~ .x %in% c(0,1))) %>%
mutate(mins=DUR_MOD_CAPPED_SPORTCOUNT_A01 +
DUR_HVY_CAPPED_SPORTCOUNT_A01,
Gend3 = Gend3-1,
Eth2 = Eth2-1,
age = case_when(Age9==2~3L,
Age9==9~8L,
TRUE~as.integer(Age9)),
age=as.integer(age-2)
) %>%
dplyr::select(enjoyb=Motiva_POP_GR2,
socialb=motivex2c_GR2,
fitb=motivex2a_GR2,
guiltb=motivc_POP_GR2,
oppb=READYOP1_POP_GR2,
gender=Gend3,
age,
eth=Eth2,
mins
)
dallb <- bind_rows(
adult.bi %>% mutate(group = "adult"),
child.bi %>% mutate(group = "youth")
) %>%
mutate(mins = ifelse(mins > 1680, 1680, mins))
dallb <- bind_rows(
adult.bi %>% mutate(group = "adult"),
child.bi %>% mutate(group = "youth")
) %>%
mutate(mins = ifelse(mins > 1680, 1680, mins))
dallb$gender <- relevel(factor(dallb$gender), ref = "1")
dallb$eth <- relevel(factor(dallb$eth), ref = "1")
dallb$age <- relevel(factor(dallb$age), ref = "1")
unique(adult.bi$age)
adult.bi <- adult.var %>% filter(Disab2_POP==2,
Gend3 %in% c(1,2),
Eth2 %in% c(1,2),
if_all(c(AgeTGC,
DUR_MOD_CAPPED_SPORTCOUNT_A01,
DUR_HVY_CAPPED_SPORTCOUNT_A01),
~ .x > -1),
if_all(c(Motiva_POP_GR2, motivex2c_GR2,
motivex2a_GR2, motivc_POP_GR2,
READYOP1_POP_GR2),
~ .x %in% c(0,1))) %>%
mutate(mins=DUR_MOD_CAPPED_SPORTCOUNT_A01 +
DUR_HVY_CAPPED_SPORTCOUNT_A01,
Gend3 = Gend3-1,
Eth2 = Eth2-1,
age = case_when(Age9==2~3L,
Age9==9~8L,
TRUE~as.integer(Age9)),
age=as.integer(age-3)
) %>%
dplyr::select(enjoyb=Motiva_POP_GR2,
socialb=motivex2c_GR2,
fitb=motivex2a_GR2,
guiltb=motivc_POP_GR2,
oppb=READYOP1_POP_GR2,
gender=Gend3,
age,
eth=Eth2,
mins
)
unique(child.bi$age)
dallb <- bind_rows(
adult.bi %>% mutate(group = "adult"),
child.bi %>% mutate(group = "youth")
) %>%
mutate(mins = ifelse(mins > 1680, 1680, mins))
dallb$gender <- relevel(factor(dallb$gender), ref = "0")
dallb$eth <- relevel(factor(dallb$eth), ref = "0")
dallb$age <- relevel(factor(dallb$age), ref = "0")
unique(child.bi$age)
f0 <- sem(m0, data = dallb, group = "group")
unique(child.bi$age)
dallb$age <- factor(dallb$age, levels = c(0,1,2,3,4,5))
dallb$age <- relevel(factor(dallb$age), ref = "0")
f0 <- sem(m0, data = dallb, group = "group")
dallb$age <- factor(dallb$age, levels = c(0,1,2,3,4,5))
f0 <- sem(m0, data = dallb, group = "group")
dallb$age <- order(dallb$age, levels = c(0,1,2,3,4,5))
dallb$age <- ordered(dallb$age, levels = c(0,1,2,3,4,5))
f0 <- sem(m0, data = dallb, group = "group")
dallb$age <- ordered(dallb$age, levels = c("0","1","2","3","4","5"))
f0 <- sem(m0, data = dallb, group = "group")
adult.bi <- adult.var %>% filter(Disab2_POP==2,
Gend3 %in% c(1,2),
Eth2 %in% c(1,2),
if_all(c(AgeTGC,
DUR_MOD_CAPPED_SPORTCOUNT_A01,
DUR_HVY_CAPPED_SPORTCOUNT_A01),
~ .x > -1),
if_all(c(Motiva_POP_GR2, motivex2c_GR2,
motivex2a_GR2, motivc_POP_GR2,
READYOP1_POP_GR2),
~ .x %in% c(0,1))) %>%
mutate(mins=DUR_MOD_CAPPED_SPORTCOUNT_A01 +
DUR_HVY_CAPPED_SPORTCOUNT_A01,
Gend3 = Gend3-1,
Eth2 = Eth2-1,
age = case_when(Age9==2~3L,
Age9==9~8L,
TRUE~as.integer(Age9)),
age=as.integer(age-3)
) %>%
dplyr::select(enjoyb=Motiva_POP_GR2,
socialb=motivex2c_GR2,
fitb=motivex2a_GR2,
guiltb=motivc_POP_GR2,
oppb=READYOP1_POP_GR2,
gender=Gend3,
age,
eth=Eth2,
mins
)
dallb <- bind_rows(
adult.bi %>% mutate(group = "adult"),
child.bi %>% mutate(group = "youth")
) %>%
mutate(mins = ifelse(mins > 1680, 1680, mins))
dallb$gender <- relevel(factor(dallb$gender), ref = "0")
dallb$eth <- relevel(factor(dallb$eth), ref = "0")
f0 <- sem(m0, data = dallb, group = "group")
varTable(fit)
varTable(fit0)
sem.free <- summary(f0, fit.measures = TRUE, standardized = TRUE)
sem.free
or.ch
or.ad
probs.adult <- poLCA.adult[[3]]$probs
# Convert list to a long data frame: one row per variable-response-class
probs.adult.l <- lapply(names(probs.adult), function(var) {
mat <- probs.adult[[var]]
df <- as.data.frame(mat)
df$Response <- rownames(mat)
df$Variable <- var
df
}) %>%
bind_rows() %>%
pivot_longer(
cols = starts_with("Response"),
names_to = "Type",
values_to = "Class"
)
class1.ad <- probs.adult.l %>% filter(Class == "class 1: ") %>%
dplyr::select(-Type,-Class) %>%
arrange(Variable) %>%
relocate(Variable, 'Pr(1)','Pr(2)','Pr(3)','Pr(4)')
class2.ad <- probs.adult.l %>% filter(Class == "class 2: ") %>%
dplyr::select(-Type,-Class) %>%
arrange(Variable) %>%
relocate(Variable, 'Pr(1)','Pr(2)','Pr(3)','Pr(4)')
class3.ad <- probs.adult.l %>% filter(Class == "class 3: ") %>%
dplyr::select(-Type,-Class) %>%
arrange(Variable) %>%
relocate(Variable, 'Pr(1)','Pr(2)','Pr(3)','Pr(4)')
class1.ad
class2.ad
class3.ad
or.ad
prop.table(table(adult.lik$class))
adult.lik$age <- relevel(factor(adult.lik$age), ref = 1)
unique(adult.lik$age)
fit.ad <- multinom(class ~ age + edu + gender + eth,
data = adult.lik %>%
dplyr::select(-post,-mins))
summary(fit.ad)
# Odds ratios for easier interpretation
exp(coef(fit.ad))
or.ad <- exp(coef(fit.ad))
sem.free
dallb <- bind_rows(
adult.bi %>% mutate(group = "adult"),
child.bi %>% mutate(group = "youth")
) %>%
mutate(mins = ifelse(mins > 1680, 1680, mins))
dallb$gender <- relevel(factor(dallb$gender), ref = "0")
dallb$eth <- relevel(factor(dallb$eth), ref = "0")
f0 <- sem(m0, data = dallb, group = "group")
sem.free <- summary(f0, fit.measures = TRUE, standardized = TRUE)
sem.free
f0 <- sem(m0, data = dallb, group = "group")
